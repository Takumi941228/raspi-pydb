# Raspberry Piを活用したデータ処理とグラフ表示によるIoTシステム構築

## 課題

これまでの実習で、「RaspberryPiとBME280で取得した温度・湿度・気圧をMQTT経由で送信する」ことができました。また、「MQTTブローカからのデータをデータベースに追加する」ことができました。そして、蓄積したデータをグラフで表示することができました。

これまでに製作したプログラムを組み合わせて、以下の要素からなるシステムを製作してください。

* ESP32が搭載された自作IoT基板を製作する。（回路とソースコードは「6. MQTT経由のデータの取得と蓄積」を参照）
    * ESP32のプログラムを変更する。
        * LCDの表示内容の変更（常に１行目に現在時間を表示）（２行目に温度か湿度か気圧「タクトスイッチによる切り替え」を表示）

        |行数|操作|内容|
        |---|---|---|
        |１行目|常に（SW押下中は、消えても良い）|時:分:秒|
        |２行目|黄SW押下|T:●●.●●|
        |２行目|緑SW押下|P:●●.●●|
        |２行目|赤SW押下|H:●●●●|

        * 黄SW押下、黄LEDが点灯、LCDに温度値を小数点第二位まで表示（「T:23.82」）
        * 緑SW押下、緑LEDが点灯、LCDに気圧値を整数のみ表示（「P:1013」100で割ったものをint型にキャスト変換する良い）
        * 赤SW押下、赤LEDが点灯、LCDに湿度値を小数点第二位まで表示（「H:29.76」）

* 自分のRaspberryPiをMQTTブローカとして、ESP32に接続されたBME280で取得した温度・湿度・気圧と時間を１０秒毎にMQTT経由で送信する。
    * topic名:esp32/bme280
    * device名:esp32-1

* 自分のRaspberryPiのMQTTブローカからのデータを受信し、受信し日付を付与して、新しく作成したデータベースに蓄積する。
    * ユーザ名:sangi_自分の名前（例：sangi_hirota「パスワード：Passw0rd」）
    * データベース名：sangi_storage
    * テーブル名：environment
    * 識別ノードID:sangi_mqtt_esp32

* 蓄積したデータを使って、「8. グラフによるデータの可視化」を参考に、温度・湿度・気圧のグラフをリアルタイムに表示する。
